!function(){var t=function(a,n,i){var o=this,r={prefix:"widget",isRange:!1,limitRange:[],highlightRange:[],onChange:function(){},onSelect:function(){}};n=n||{},i=i||function(){};for(var s in r)"undefined"==typeof n[s]&&(n[s]=r[s]);if(this.options=n,this.container=e(a),this.container.length>1){var h=[];return this.container.each(function(){h.push(new t(this,n,i))}),h}this.$this=this.container,this.$this[0].innerHTML='<table class="table table-striped table-condensed">                    <caption>                        <a class="'+this.options.prefix+'-prevYear" href="javascript:;">&lt;&lt;</a>                        <a class="'+this.options.prefix+'-prevMonth" href="javascript:;">&lt;</a>                        <span class="'+this.options.prefix+'-title"></span>                        <a class="'+this.options.prefix+'-nextMonth" href="javascript:;">&gt;</a>                        <a class="'+this.options.prefix+'-nextYear" href="javascript:;">&gt;&gt;</a>                        <a class="'+this.options.prefix+'-back" href="javascript:;">今天</a>                    </caption>                    <thead>                        <tr><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr>                    </thead>                    <tbody></tbody>                </table>',this.$tbody=this.$this.find("tbody"),this.$prevYear=this.$this.find("."+this.options.prefix+"-prevYear"),this.$prevMonth=this.$this.find("."+this.options.prefix+"-prevMonth"),this.$title=this.$this.find("."+this.options.prefix+"-title"),this.$nextMonth=this.$this.find("."+this.options.prefix+"-nextMonth"),this.$nextYear=this.$this.find("."+this.options.prefix+"-nextYear"),this.$back=this.$this.find("."+this.options.prefix+"-back"),this._today,this._data,this._day,this._range=[],o.init(),i(this)};t.prototype={init:function(){var t=this;t._today=t.getDateObj(),t._day={year:t._today.year,month:t._today.month},t.$prevMonth[0].addEventListener("click",function(){t._day.month--,t._data=t.getData(t._day),t.format(t._data)},!1),t.$nextMonth[0].addEventListener("click",function(){t._day.month++,t._data=t.getData(t._day),t.format(t._data)},!1),t.$prevYear[0].addEventListener("click",function(){t._day.year--,t._data=t.getData(t._day),t.format(t._data)},!1),t.$nextYear[0].addEventListener("click",function(){t._day.year++,t._data=t.getData(t._day),t.format(t._data)},!1),t.$back[0].addEventListener("click",function(){t._data=t.getData(),t.format(t._data)},!1),t.$this[0].addEventListener("click",function(e){e=e||window.event;var a=e.srcElement||e.target;if("TD"==a.tagName.toUpperCase()||"TD"==a.parentNode.tagName.toUpperCase()){var n="TD"==a.parentNode.tagName.toUpperCase()?a.parentNode:a,i=n.getAttribute("data-id"),o=t._data[i];"disabled"!=o.status&&(t.options.isRange?1!=t._range.length?(t._range=[o],t.format(t._data)):(t._range.push(o),t._range.sort(function(t,e){return t.code>e.code}),t.format(t._data),t.options.onSelect(t._range)):(t._range=[o],t.format(t._data),t.options.onSelect(t._range)))}},!1),t._data=t.getData(),t.format(t._data)},getDateObj:function(t,e,a){var n=arguments.length&&t?new Date(t,e-1,a):new Date,i={year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate(),week:n.getDay()};return i.code=""+i.year+(i.month>9?i.month:"0"+i.month)+(i.day>9?i.day:"0"+i.day),i},getMonthDays:function(t){var e=new Date(t.year,t.month,0);return e.getDate()},getDateInfo:function(t){var e=this;if(e.options.limitRange.length){t.status="disabled";for(var a=0;a<e.options.limitRange.length;a++){var n=e.options.limitRange[a][0],i=e.options.limitRange[a][1];if("today"==n&&(n=e._today.code),"today"==i&&(i=e._today.code),n>i&&(n=[i,i=n][0]),t.code>=n&&t.code<=i){t.status="";break}}}if(t.sign=[],e.options.highlightRange.length)for(var a=0;a<e.options.highlightRange.length;a++){var n=e.options.highlightRange[a][0],i=e.options.highlightRange[a][1];if("today"==n&&(n=e._today.code),"today"==i&&(i=e._today.code),n>i&&(n=[i,i=n][0]),t.code>=n&&t.code<=i){t.sign.push("highlight");break}}return t.code==e._today.code&&t.sign.push("today"),t},getData:function(t){var e=this;"undefined"==typeof t&&(t=e._today),e._day=e.getDateObj(t.year,t.month,1);for(var a=e.getMonthDays(e._day),n=[],t={},i=e._day.week;i>0;i--){t=e.getDateObj(e._day.year,e._day.month,e._day.day-i);var o=e.getDateInfo(t);e.options.limitRange.length||(o.status="disabled"),n.push(o)}for(var i=0;i<a;i++){t={year:e._day.year,month:e._day.month,day:e._day.day+i,week:(e._day.week+i)%7},t.code=""+t.year+(t.month>9?t.month:"0"+t.month)+(t.day>9?t.day:"0"+t.day);var o=e.getDateInfo(t);n.push(o)}for(var r=t,i=1;r.week+i<7;i++){t=e.getDateObj(r.year,r.month,r.day+i);var o=e.getDateInfo(t);e.options.limitRange.length||(o.status="disabled"),n.push(o)}return n},format:function(t){var e=this;e.options.onChange(e._day);for(var a=0;a<t.length;a++){var n=t[a];"active"==n.status&&(n.status="")}if(2==e._range.length)for(var i=e._range[0].code,o=e._range[1].code,a=0;a<t.length;a++){var n=t[a];if(n.code>=i&&n.code<=o){if("disabled"==n.status){e._range[1]=n;break}n.status="active"}}else if(1==e._range.length)for(var a=0;a<t.length;a++){var n=t[a];n.code==e._range[0].code&&(n.status="active")}for(var r="<tr>",a=0,s=t.length;a<s;a++){for(var h=t[a],d=[],f=0;f<h.sign.length;f++)d.push(e.options.prefix+"-"+h.sign[f]);h.status&&d.push(e.options.prefix+"-"+h.status);var g=d.join(" ");r+="<td"+(g?' class="'+g+'"':"")+' data-id="'+a+'">                                '+(h.link?'<a href="'+h.link+'">'+h.day+"</a>":"<span>"+h.day+"</span>")+"                            </td>",a%7==6&&a<s-1&&(r+="</tr><tr>")}r+="</tr>",e.$title[0].innerHTML=e._day.year+"年"+e._day.month+"月",e.$tbody[0].innerHTML=r}};var e=function(){var t=function(t){var e=this,a=0;for(a=0;a<t.length;a++)e[a]=t[a];return e.length=t.length,this};t.prototype={addClass:function(t){if("undefined"==typeof t)return this;for(var e=t.split(" "),a=0;a<e.length;a++)for(var n=0;n<this.length;n++)this[n].classList.add(e[a]);return this},each:function(t){for(var e=0;e<this.length;e++)t.call(this[e],e,this[e]);return this},html:function(t){if("undefined"==typeof t)return this[0]?this[0].innerHTML:void 0;for(var e=0;e<this.length;e++)this[e].innerHTML=t;return this},find:function(e){for(var a=[],n=0;n<this.length;n++)for(var i=this[n].querySelectorAll(e),o=0;o<i.length;o++)a.push(i[o]);return new t(a)},append:function(e){var a,n;for(a=0;a<this.length;a++)if("string"==typeof e){var i=document.createElement("div");for(i.innerHTML=e;i.firstChild;)this[a].appendChild(i.firstChild)}else if(e instanceof t)for(n=0;n<e.length;n++)this[a].appendChild(e[n]);else this[a].appendChild(e);return this}};var e=function(e,a){var n=[],i=0;if(e&&!a&&e instanceof t)return e;if(e)if("string"==typeof e){var o,r,s=e.trim();if(s.indexOf("<")>=0&&s.indexOf(">")>=0){var h="div";for(0===s.indexOf("<li")&&(h="ul"),0===s.indexOf("<tr")&&(h="tbody"),(0===s.indexOf("<td")||0===s.indexOf("<th"))&&(h="tr"),0===s.indexOf("<tbody")&&(h="table"),0===s.indexOf("<option")&&(h="select"),r=document.createElement(h),r.innerHTML=e,i=0;i<r.childNodes.length;i++)n.push(r.childNodes[i])}else for(o=a||"#"!==e[0]||e.match(/[ .<>:~]/)?(a||document).querySelectorAll(e):[document.getElementById(e.split("#")[1])],i=0;i<o.length;i++)o[i]&&n.push(o[i])}else if(e.nodeType||e===window||e===document)n.push(e);else if(e.length>0&&e[0].nodeType)for(i=0;i<e.length;i++)n.push(e[i]);return new t(n)};return e}();window.calendar=t}();
